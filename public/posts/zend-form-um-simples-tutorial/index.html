<!--
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256

- -->
<!--
- -----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256

- - -->
<!--
- - -----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256

- - - -->
<!--
- - - -----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256

- - - - -->
<!doctype html><html lang=en><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="shrink-to-fit=no,width=device-width,height=device-height,initial-scale=1,user-scalable=1"><meta name=description content="My corner of the web"><title>Adler Medrado's little piece of turf</title>
<link rel=author href=/humans.txt><link rel=canonical href=https://adlermedrado.com.br><link href=/css/styles.css rel=stylesheet></head><body><header><nav class=navbar role=navigation><div class=navbar_left><a href=/><strong>Adler Medrado</strong></a></div><div class=navbar_right><a href=/posts>Posts</a>
<a href=/tags>Posts by Tags</a></div></nav></header><main><section class=section><article><div><h1>Zend_Form: Um simples tutorial</h1><div><div><p><small><time>September 14, 2008</time>
|
6 minutes read</small></p></div><span class=line_break></span></div><div class=content><p>Introdução</p><p>Depois de algum tempo sem escrever algo sobre o Zend Framework, venho hoje mostrar rapidamente um exemplo de como usar
o <code>Zend_Form</code> e de quebra vou mostrar o <code>Zend_Translator</code>, que pode ser usado em internacionalização.</p><p>O <code>Zend_Form</code> é um componente que permite que formulários sejam criados e mantido em um objeto, aumentando produtividade
e mantendo um padrão de desenvolvimento. É possível também com o <code>Zend_Form</code>, a implementação de formulários com
herança, ou seja, você tem um formulário genérico (ex: <code>UsuarioForm</code>) que pode ser utilizado para criação de outros (ex:
<code>UsuarioAdminForm</code>) que possuiriam apenas alguns campos adicionais além do form padrão.</p><p>Ele também possui componentes que permitem a utilização de todos os Filters e Validators do Zend, bem como a
implementação de Componentes personalizados.</p><p><strong>Mãos à obra</strong></p><p>Vamos criar um formulário de contato com o Zend_Form para ser o exemplo deste tutorial.
Este formulário terá os campos Nome, Email, Assunto e Mensagem.</p><p>Se fôssemos criar um formulário da maneira convencional, serial algo assim:</p><pre><code>&lt;html&gt;
    &lt;head&gt;
        &lt;title&gt;Exemplo de form&lt;/title&gt;
    &lt;/head&gt;
    &lt;body&gt;
        &lt;form&gt;
            Nome: &lt;input type=&quot;text&quot; id=&quot;nome&quot; name=&quot;nome&quot;&gt;
            Email: &lt;input type=&quot;text&quot; id=&quot;email&quot; name=&quot;email&quot;&gt;
            Assunto: &lt;input type=&quot;text&quot; id=&quot;assunto&quot; name=&quot;email&quot;&gt;
            Mensagem: &lt;textarea rows=&quot;5&quot; cols=&quot;5&quot; id=&quot;mensagem&quot; name=&quot;mensagem&quot;&gt;&lt;/textarea&gt;
            &lt;button id=&quot;enviar&quot;&gt;Enviar&lt;/button&gt;
        &lt;/form&gt;
    &lt;/body&gt;
&lt;/html&gt;
</code></pre><p>E se fôssemos usar os <code>Zend_View_Helpers</code> para criar os campos, ficaria mais ou menos assim:</p><pre><code>&lt;html&gt;
    &lt;head&gt;
        &lt;title&gt;Exemplo de form&lt;/title&gt;
    &lt;/head&gt;
    &lt;body&gt;
        &lt;form&gt;
            Nome: &lt;?php echo $this-&gt;formText('nome') ?&gt;
            Email: &lt;?php echo $this-&gt;formText('email') ?&gt;
            Assunto: &lt;?php echo $this-&gt;formText('assunto') ?&gt;
            Mensagem: &lt;?php echo $this-&gt;formTextare('nome', null, array('rows' =&gt; 5, 'cols' =&gt; 5)) ?&gt;
            &lt;?php echo $this-&gt;formButton('salvar', 'Salvar') ?&gt;
        &lt;/form&gt;
    &lt;/body&gt;
&lt;/html&gt;
</code></pre><p><strong>Agora vem o Zend_Form</strong></p><p>A diferença principal entre estas duas maneiras e a maneira utilizando Zend_Form é que nós podemos definir regras de
validação no servidor diretamente no objeto do form.</p><p>Antes de usar o form, nós devemos criar uma classe que deriva da classe Zend_Form.
Antes de criarmos o código PHP do formulário, devemos criar um diretório para guardar estas classes.
Eu normalmente crio um diretório forms dentro do diretório da minha aplicação e o incluo no meu include_path.
Eu já vi algumas pessoas colocando os forms dentro do diretório de models. Enfim, o Zend Framework te dá uma
flexibilidade para
definir o que é melhor para você.</p><p>Vejamos o código do formulário, que se chama <code>ContatoForm.php</code> e está no meu diretório forms conforme citado acima:</p><pre><code>&lt;?php
class ContatoForm extends Zend_Form
{

    public function __construct($options = null)
    {
        parent::__construct($options);
        $this-&gt;generate();
    }

    private function generate()
    {
        $this-&gt;setName('contato'); 
        $nome = new Zend_Form_Element_Text('nome');
        $nome-&gt;setLabel('Nome')-&gt;setRequired(true)
        -&gt;addFilter('StripTags')
        -&gt;addValidator('NotEmpty');

        $email = new Zend_Form_Element_Text('email');
        $email-&gt;setLabel('email')-&gt;setRequired(true)
        -&gt;addFilter('StripTags')
        -&gt;addValidator('NotEmpty');

        $assunto = new Zend_Form_Element_Select('assunto');
        $assunto-&gt;setLabel('Etapa')
        -&gt;setRegisterInArrayValidator(false)
        -&gt;setRequired(true)
        -&gt;addFilter('StripTags')
        -&gt;addValidator('NotEmpty');

        $arrOpcoes = array('Selecione',
        'criticas'    =&gt; 'Críticas',
        'sugestoes'   =&gt; 'Sugestões',
        'informacoes' =&gt; 'Informações' );
        $assunto-&gt;addMultiOptions($arrOpcoes);

        $mensagem = new Zend_Form_Element_Textarea('mensagem');
        $mensagem-&gt;setAttrib('rows', '5');
        $mensagem-&gt;setAttrib('cols', '5');
        $mensagem-&gt;setLabel('mensagem')-&gt;setRequired(true)
        -&gt;addFilter('StripTags')
        -&gt;addValidator('NotEmpty');
        
        $submit = new Zend_Form_Element_Submit('submit');
        $submit-&gt;setAttrib('id', 'salvar');
        $submit-&gt;setAttrib('class', 'verde buttonBar');
        $this-&gt;addElements(array($nome, $email, $assunto, $mensagem,  $submit));
    }
}
</code></pre><p>Analisando o código acima, é possível ver que utilizamos os plugins do Zend_Form para criar os campos e botão do nosso
formulário, e em cada elemento do form nós definimos o filtro StripTags e o Validator NotEmpty, que acredito devem ter
ficado claros para que que servem. :D</p><p>No campo assunto, todos os elementos do select são definidos no array $arrOpcoes, sendo o índice o value e o valor o
texto. Sendo assim, é muito fácil colocar dados que estão em banco de dados no select.</p><p>No campo da mensagem, no TextArea, nós definimos os atributos rows e cols utilizando o método setAttrib. Isso vale para
qualquer componente.</p><p>No final, associamos estes campos no form e o form está pronto.</p><p><strong>Criação do Controller</strong></p><p>Agora, vamos fazer um controller para receber estes dados:</p><pre><code>&lt;?php
class ExemploGridController extends Zend_Controller_Action
{
    public function indexAction()
    {
        $this-&gt;view-&gt;titulo = 'Contato!';
        
        $form = new ContatoForm();
        $form-&gt;submit-&gt;setLabel('Enviar');
        $this-&gt;view-&gt;form = $form;
    
        if ($this-&gt;_request-&gt;isPost()) {
            $formData = $this-&gt;_request-&gt;getPost();
        
            if ($form-&gt;isValid($formData)) {
                // Implementa a rotina para envio de email
            } else {
                // Mostra os erros e popula o form com os dados enviados
                $form-&gt;populate($formData);
            }
        }
    }
}
</code></pre><p>No Controller, nós obtemos o objeto do formulário e associamos ao objeto Zend_View, depois verificamos se a requisição é do tipo POST (se for, o form foi submetido) e então verificamos se os dados enviados são válidos (os filters e validators que colocamos no form). Se forem válidos, enviaria o email (este exemplo simula um form de contatos, lembra ? :D ) senão, popula o form e mostra as mensagens de erro. Se a requisição não for do tipo POST, o form é renderizado na tela.</p><p>No arquivo de template (<code>index.phtml</code>) nós apenas damos um echo no form (<code>echo $this->form</code>).</p><p>Abaixo teremos um screenshot do form antes de ser submetido e outra do form após ser submetido com dados incorretos para mostrar os erros retornados pelo objeto.</p><p>Se você viu a segunda screenshot, percebeu que as mensagens de erro estão em inglês, certo? Isso ocorre porque o idioma padrão para o ZF é o inglês e é aí que vai entrar o Zend_Translate, que usaremos para traduzir estas mensagens de erro.</p><p><strong>Traduzindo as mensagens de erro</strong></p><p>Conforme a documentação do Zend Framework, o <code>Zend_Translate</code> é a solução para aplicações multilinguisticas.</p><p>Existem diversas formas de se criar um objeto <code>Zend_Translate</code> e você pode obter maiores detalhes na documentação. Eu irei usar neste tutorial o meio que julgo ser o mais simples, que é criando o dicionário em um array e depois associar ele com o objeto <code>Zend_Translate</code>.</p><p><strong>Vejamos:</strong></p><p>Eu criei um diretório em minha aplicação chamado i18n e da mesma maneira coloquei-o no include_path. Dentro dele, o arquivo pt_Br.php foi criado e nele contém o array com as traduções.</p><p>Eu vou colocar o array aqui de maneira reduzida para não ficar muito extenso:</p><pre><code>&lt;?php
// Traducao para o Portugues
$portugues = array();
$portugues['isEmpty']= 'Este campo não pode ser vazio';

// Email
$portugues['emailAddressInvalid'] = 'não é um email válido no formato nome@servidor';
</code></pre><p>Como podemos ver, <code>isEmpty</code> e <code>emailAddressInvalid</code> são palavras-reservadas dos filtros usados no <code>Zend_Form</code>.
Eu senti uma dificuldade para encontrar estas informações na documentação, até onde pesquisei esta parte ainda não havia sido documentada, então para encontrar as palavras reservadas eu tive que abrir as classes, uma a uma para traduzi-las.</p><p>Agora nós devemos associar este array com o objeto <code>Zend_Translator</code> para então informar ao Form que ele deve ser traduzido. Vamos lá:</p><pre><code>// Carregando arquivo de internacionalização

include_once 'i18n.php';
$translate = new Zend_Translate('array', $portugues, 'pt_BR');
$registry-&gt;set('translate', $translate);
</code></pre><p>Eu crio o objeto <code>Zend_Translate</code>, passando o array <code>$portugues</code> que criei no arquivo <code>i18n.php</code> e guardo este objeto na Registry para poder ser usado posteriormente. Existem outras formas de persistir este objeto, mas eu prefiro desta maneira, então sinta-se a vontade para mudar se achar uma maneira mais conveniente para você.</p><p>No <code>Zend_Form</code> eu digo para ele usar este arquivo, adicionando o código abaixo no metodo <code>init()</code> do <code>ContatoForm</code>:</p><pre><code>$translate = Zend_Registry::get('translate');
$this-&gt;setTranslator($translate);
</code></pre><p>Pronto! Agora seus erros serão traduzidos, conforme screenshot abaixo:</p><p>Simples não? Uma vez criado o objeto <code>Zend_Translate</code>, você pode tornar esse processo de tradução dinâmico, daí o trabalho será feito apenas uma única vez.</p><p><strong>Considerações Finais</strong></p><p>Espero que eu tenha conseguido ser claro neste tutorial e que ele seja proveitoso para você. Aproveito para lembrar que este foi um tutorial básico, apenas uma introdução ao Zend_Form, que possui diversos recursos que não abordamos hoje. Espero em breve poder mostrá-los para vocês.</p><p>Eu estou usando o <code>Zend_Form</code> no meu dia-a-dia no trabalho e nossa equipe teve um aumento na produtividade muito grande.</p><p>Bem, tentem implementar um exemplo como esse e qualquer dúvida poste aqui no blog que a gente tenta se ajudar. Se tiver alguma dica adicional, deixa-e aqui também.</p><p>Vamos lá, o que está esperando para testar? :D</p><p>Abraços.</p></div></div></article><div><div><div><a href=https://adlermedrado.com.br/posts/dia-do-programador/>&#8592; Dia do Programador</a>
|
<a href=https://adlermedrado.com.br/posts/mini-curso-solidario/>Mini-curso Solidário &#8594;</a></div></div></div></section></main><span class=line_break></span>
<span class=line_break></span><footer><div><p><small>&copy; 1996-2023 Adler Medrado</small></p></div><div class=gpg_signed_info><p>All pages on this website are PGP signed.
Import my <a href=/pub-key.asc>public key</a> and check with <em>curl https://adlermedrado.com.br/posts/zend-form-um-simples-tutorial/ | gpg --verify</em></p></div></footer></body></html><!--
- - - -----BEGIN PGP SIGNATURE-----

iQIzBAEBCAAdFiEEOakOfYA7XALT7+un/2dtxSoBkcMFAmWRhTMACgkQ/2dtxSoB
kcNaaBAAuHxjHK4D4MsEIX6WAfHfB1x0EUHLD/HP+XLkL1KSPPmtSYdZf0mSwy9w
azniCiDPKm669nw++xh/Jy1CpR5RG5bOJdXTULedsWSC4NgvMjfPFM7yBFMykxM/
Jl5aO1Q8wMTZ8JHeyDjNXnJ1MYWn2fMS7ZchSUtpNRfwtjjI6kM3f39kzZyze/4+
FTqcQah1OQbKngRATnbGmc1zoxjqdc3M8zeyUGYlPFBwwa7fFhG/Srz5cmNz1aIe
q7vw+H3Sjd72uRWcl4IYrPSracCOllhVpI5MfoizmLzP/ivacwdwrvU13/yXy5c6
xHTi06Oo7QFogCjCJpijfJsOzPZxd8X2zGNuk6eRmCUHgMFa2ySI5y8zSRT6V9CQ
SE+Xwtf15j19IqwR/2LqUPNg99tNks8/PRrXEZ9R7TRI9nuSb8WjP3sy/rt5cbzh
n6360EIZ8IouivdzcgA5i9UutWB0E/1Mw5mGFmeCxisz6bUw4FdwCB5nLZ3KEUjG
Gor3BXBbXOhyBj3ISMQCE5WBBD8TfWJFJ1jnl7E8Uvr4OwIxPIrBIE/R4+VhkXBE
FtAUuqFq6yjwvdCDStmycB/NZMqV69dHIxPTYgG/ega5hPSco3XnFVUu2/7YOJo3
oEI003uFomr7CZNa27N9fCPNZJTI9tfIf9+VaQvNXbymsBnRrnA=
=yCDj
- - - -----END PGP SIGNATURE-----
- - - -->
<!--
- - -----BEGIN PGP SIGNATURE-----

iQIzBAEBCAAdFiEEOakOfYA7XALT7+un/2dtxSoBkcMFAmWRjxsACgkQ/2dtxSoB
kcPJ1BAAwf/hTwWrF5ihm65JeSx+1srghDH/W2mwsm2W8Niw/YaGoNKpGsFnYcaA
o+flHoZ5Pw9BHpa8N/MVAT0RHujTN6zE1AVlieW8rhGCYnGHwqQ0MFCtS5lCw1sa
FbJwIuIF4DMcdDBTQh5uxXuHQflhK9xIBEXwVyYulmczW7ZnRGemBcxUTUHiitFt
vqTYhhJ1k2XxOscnCIUpyz9yXdhMEiT/wZumHPsyDey6NAbVXVwTEtJRwF52fVxF
vi9DG/noeN4DjmGE32b96ZUBDz0tzKCi6TChkXNocUk0Wnv5xYIWILcmimDYsBfR
2dJANfIKSo6Enq7hPS10FhYWzypbLigclQsWrSyhU24tcH0U84A/BWNNn6sNWwYC
Sq/DLrOG/aQgTCXADnTlRCZbSx/qWeorE/sDwIsE9Gig+EU1uUpxs+ucTx5n6p0D
rI1xR19W+i0/Ps6UcUsllywfb8nxTgv1dpROksERJb06S1eoFyKTRS/C4AOuhOTB
r4A0plG8fLpGeGHjq6XyLqZf/IwXINUdXSDNCdgqFKSjVXwBDZeBiM11NzbmEQLR
RcAEn5grnSkU0/Lm69cppVdgWfM7aRV8L4+fHpkh4jJEWk32843DCSyTaGXYitMS
v4YoFbN0ZHZbOhG1teigXG9wq5LYW+bIQzHz2jfPr965RLWbES0=
=mewq
- - -----END PGP SIGNATURE-----
- - -->
<!--
- -----BEGIN PGP SIGNATURE-----

iQIzBAEBCAAdFiEEOakOfYA7XALT7+un/2dtxSoBkcMFAmWRj+8ACgkQ/2dtxSoB
kcNg1w//Yq4KXGQH2sbnrHQA//N/zsy3y449XZzsGPdrxbpvA4nn5tRcOOykoLKq
b3IwNH5pXeZZeFyCdRLwh+W602vjTvxGmRJAMU9oZ3zsVz/lddgpiDjTmF6OrlkE
mDOK6dOAmerIZvvLdk/Puw8SGloFBiHZkmIxstPL61Ek5hXbsyyJOnbJ+3taKl7E
lycgenSxEvOqFPKy5wAzpLr4aBUiOcJdc4tpqRV1MyfTVrUz+Yyyv1VxlUsKDe/l
ASt2ZqGV3qMfimZRZQPfoGAPAU0v5Ix3gkjIG7nKf8dxh5N8WBI0/TpwluVKGEF3
iKBHbGueVcgpXLw0XP6ACbwLzJGdTS5ca/CwsOh6tcJ6ySgsSkzraITmw89s8aN+
dn025Le+KYERtx7o6t7cc44gU54tWu4PRfYjgOVHq8FaEtgKbUAL2bzGILPRj05N
fDTwM6HlG+PKYWMeUt3QIMYrP1ukDtghRbyLOnWRI2Hlv76vf5/N8nln3QAxY0IA
Nntkmoc0OV1U0p7wGB1naz9cAvH6Sx2tj6R+p7/tzHLhdnacklxk9RYudVCXDBgi
B4NFvpO6MHI82ykW+2Se74ZXoqMv2rtEKuXSLuVq8hdJFDrOt9pWiMJT2+SXFj5O
mHIvhDTGo17imHr7U6Ixuf58FVxVK3eBoST3EmUwfhICxtea59o=
=ygHA
- -----END PGP SIGNATURE-----
- -->
<!--
-----BEGIN PGP SIGNATURE-----

iQIzBAEBCAAdFiEEOakOfYA7XALT7+un/2dtxSoBkcMFAmWRlIYACgkQ/2dtxSoB
kcOC1Q/9HP4rKTwX5Obdk/f7E6/3OZKUMsWr6CWCD05KLMTGIKRw+cGA2EUT+n53
0BdBvjddR35H1bcMZa48X/6oF1zGzvIg0GNRD1b3hnPq+bM19OYnkIEno2t0D43j
P6sIFuBHfahzA+Th6YiI/oDBRbXTp/tkvaQlkHQPK3akA5zLSB4JyOZxJ07XwYUu
lG7KOq+UdelK+FjgbNgh0APhDmt+mKcnItH723f6PXBRSqfVjtAbLWLPXY0a0+QK
rjJTyROByqpyMbjQC2gIJwaMGa9xyoh9i+/DBlUwdu/qtIkk7IjcrpXMNfdZT7Wh
06b1c7/2qIvLh+oov4oHQ4aWQHLxDEyYA3NJwzau8gUT28Aw7FgAu7EZdUGc6xxM
8TywQ1puUQwj9aM/Nr6M7EwVhhMVYHMGrfuHkiAc8/Or+sJbwiY9K3TwJ/Y2gl9T
u1TrMOJQtiRNtWfe+fSdaIh8SnwYAlQPL5bDTtyFQ938LNhDzWM/zXsRCoYONvio
fQ4XS/Q1DmXVecOxWZHA3s2MEbLL8W2MpCgujSgLLeURzYZep9BeJeixhiN6e7Na
1XMJVk0C25Vbz0rgeDHEhZEoPZLQJp4oOC+RiDdWW+lBIK0LgwGRRXTv3W9Pg/y5
2A3ENuM1Hjb6q+S2NrRhCp76lbRVSJMzuJoaNnbLwhYK2VV32mE=
=IMx9
-----END PGP SIGNATURE-----
-->
